"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3536],{77025:function(e,t,n){n.d(t,{W:function(){return b},H:function(){return x}});var r=n(85893),o=n(56424),i=n(37497),c=n(93314),l=n(75713),a=n(11233),s=n(58171),u=n(24576),d=n(93452),f=n(19671),p=n(66421),m=n(67294),y=n(65538);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){h(e,t,n[t])}))}return e}var g=function(e){var t=e.collection,n=e.isNew,y=e.onDismiss,h=e.submitCollection,v=e.currentUser,g=function(e){e.preventDefault(),y(),w!==t.title&&(0,f.MR)((0,f.y6)({type:"collection:manage:setTitle",data:{},collection:t,currentUser:v,eventVersion:1})),j!==t.type&&(0,f.MR)((0,f.y6)({type:"collection:manage:setType",data:{newSetting:j},collection:t,currentUser:v,eventVersion:1})),O!==t.ordered&&(0,f.MR)((0,f.y6)({type:"collection:manage:setOrdered",data:{newSetting:O},collection:t,currentUser:v,eventVersion:1})),E!==t.description&&(0,f.MR)((0,f.y6)({type:"collection:manage:setDescription",data:{},collection:t,currentUser:v,eventVersion:1})),h({id:t.id,title:w,type:j,ordered:O,description:E,owner:b},t.title)},b=t.owner,x=(0,m.useState)(""),w=x[0],C=x[1],k=(0,m.useState)("private"),j=k[0],T=k[1],S=(0,m.useState)(!1),O=S[0],P=S[1],U=(0,m.useState)(""),E=U[0],N=U[1];return(0,m.useEffect)((function(){C(t.title),T(t.type),P(t.ordered),N(t.description)}),[C,T,P,N,t]),(0,r.jsx)(o.Vq,{onDismiss:y,"aria-labelledby":"modal-title",children:(0,r.jsxs)(l.l,{onSubmit:g,children:[(0,r.jsx)(d.xB,{title:n?"Create collection":"Edit collection",onDismiss:y}),(0,r.jsx)(d.fe,{children:(0,r.jsxs)("div",{className:"pt3",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:"var(--spacing-medium)"},children:[(0,r.jsxs)("div",{className:"flex flex-column",children:[(0,r.jsx)("label",{className:"pb2 f6 fw5 mid-gray",htmlFor:"name",children:"Title"}),(0,r.jsx)(a.Z,{type:"text",name:"title",value:w,maxLength:250,placeholder:"Collection Title",onChange:function(e){return C(e.target.value)}})]}),(0,r.jsxs)("div",{className:"flex flex-column",children:[(0,r.jsx)("label",{className:"pb2 f6 fw5 mid-gray",htmlFor:"type",children:"Visibility"}),(0,r.jsxs)(s.P,{name:"type",className:"w-100",onChange:function(e){return T(e.target.value)},value:j,children:[(0,r.jsx)("option",{value:"private",children:"team"===b.type?"Team Private":"Private"}),(0,p.Fh)(v,b)&&(0,r.jsx)("option",{value:"public",children:"Public"})]})]}),(0,r.jsxs)("div",{className:"flex flex-column",style:{gridColumnEnd:"span 2"},children:[(0,r.jsx)("label",{className:"pb2 f6 fw5 mid-gray",htmlFor:"name",children:"Description"}),(0,r.jsx)(u.g,{className:"h3 lh-copy",name:"description",value:E,maxLength:250,onChange:function(e){return N(e.target.value)}})]}),(0,r.jsxs)("div",{style:{gridColumnEnd:"span 2"},children:[(0,r.jsx)(c.X,{id:"ordered",label:"Ordered",checked:O,onChange:function(e){return P(e.target.checked)}}),(0,r.jsx)("div",{className:"pt2 pb1 f6 gray lh-f6",children:"Ordered collections allow you to configure the order in which notebooks are displayed to readers."})]})]})}),(0,r.jsx)(d.mz,{children:(0,r.jsxs)(i.CQ,{children:[(0,r.jsx)(i.kq,{text:"Cancel",onClick:y}),(0,r.jsx)(i.KM,{text:n?"Create collection":"Save changes",onClick:g})]})})]})})},b=(0,y.$)((function(e){var t=e.context,n=e.currentUser;return{isNew:!0,currentUser:n,collection:{id:"",title:"",type:"private",description:"",ordered:!1,owner:t.context||v({},n,{type:"individual"})}}}),(function(e){return{submitCollection:function(t){e({type:"createCollection",collection:t})}}}))(g),x=(0,y.$)((function(e,t){var n=e.currentUser;return{isNew:!1,collection:t.collection,currentUser:n}}),(function(e){return{submitCollection:function(t,n){e({type:"editCollection",collection:t,oldTitle:n})}}}))(g)},66981:function(e,t,n){n.d(t,{j:function(){return g}});var r=n(93452),o=n(3222),i=n(85893),c=n(8433),l=n(19671),a=n(67294),s=n(65538),u=(0,s.$)((function(e){return{currentUser:e.currentUser}}),(function(e){return{dispatch:e}}))((function(e){var t=e.currentUser,n=e.onDismiss,o=e.collection,a=e.dispatch;return(0,i.jsx)(r.On,{title:"Move to trash",icon:c.Z,description:"Are you sure you want to delete this collection? This operation cannot be undone. Notebooks in the collection will not be deleted.",onCancel:n,onConfirm:function(){n(),a({type:"deleteCollection",collection:o}),(0,l.MR)((0,l.y6)({type:"collection:manage:delete",data:{},collection:o,currentUser:t,eventVersion:1}))},destructive:!0})})),d=n(77025),f=n(56424),p=n(37497),m=n(75713),y=n(28925),h=(0,s.$)((function(e){return{currentUser:e.currentUser}}),(function(e){return{dispatch:e}}))((function(e){var t=e.currentUser,n=e.dispatch,o=e.onDismiss,c=e.collection,s=(0,a.useState)(""),u=s[0],d=s[1],h=c.custom_thumbnail,v=c.default_thumbnail;return(0,i.jsx)(f.Vq,{onDismiss:o,"aria-labelledby":"modal-title",children:(0,i.jsxs)(m.l,{onSubmit:function(e){e.preventDefault(),n({type:"setCollectionThumbnail",thumbnail:u,collection:c}),(0,l.MR)((0,l.y6)({type:"collection:manage:setThumbnail",data:{},collection:c,currentUser:t,eventVersion:1})),o()},children:[(0,i.jsx)(r.xB,{title:"Set preview image",onDismiss:o}),(0,i.jsx)(r.fe,{children:(0,i.jsx)(y.E,{thumbnail:h,defaultThumbnail:v,onValueChange:function(e){d(e)}})}),(0,i.jsx)(r.mz,{children:(0,i.jsxs)(p.CQ,{children:[(0,i.jsx)(p.kq,{text:"Cancel",onClick:o}),(0,i.jsx)(p.KM,{text:"Set image",type:"submit"})]})})]})})}));function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=(0,r.zm)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){v(e,t,n[t])}))}return e}({},o.$,{createCollection:d.W,editCollection:d.H,deleteCollection:u,setThumbnail:h}))},68298:function(e,t,n){n.d(t,{R:function(){return w}});var r=n(34051),o=n.n(r),i=n(602),c=n(19671),l=n(70915),a=n(36448),s=n(11163);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t,n,r,o,i,c){try{var l=e[i](c),a=l.value}catch(s){return void n(s)}l.done?t(a):Promise.resolve(a).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){d(i,r,o,c,l,"next",e)}function l(e){d(i,r,o,c,l,"throw",e)}c(void 0)}))}}function p(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var m=function(){var e=f(o().mark((function e(t,n,r){var i,a,u,d,f,p,m,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.context,a=t.currentUser,u=n.collection,d=u.type,f=u.title,p=u.description,m=i.context,r({type:"showProcessingToast",key:"createCollection",message:"Creating collection\u2026"}),e.prev=3,e.next=6,(0,l.BL)(f,d,m||a,p);case 6:if(y=e.sent){e.next=10;break}return r({type:"showErrorToast",key:"createCollection",message:"Oops, Creating collection failed. Try again?"}),e.abrupt("return");case 10:(0,c.MR)((0,c.y6)({type:"collection:manage:create",data:{trigger:"click",source:"createCollectionModal"},eventVersion:1,collection:y,currentUser:a})),r({type:"showSuccessToast",key:"createCollection",message:"Collection created."}),s.default.replace((0,l.WG)(y)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r({type:"showErrorToast",key:"createCollection",message:"Oops, Creating collection failed. Try again?"});case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t,n,r){return e.apply(this,arguments)}}(),y=function(){var e=f(o().mark((function e(t,n,r){var c,l,a,u,d,f,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.collection,l=n.oldTitle,r({type:"showProcessingToast",key:"editCollection",message:'Editing collection "'.concat(l,'"\u2026')}),e.prev=2,a=c.id,u=c.title,d=c.description,f=c.type,p=c.ordered,e.next=6,(0,i.Fv)("/collection/".concat(a,"/edit"),{title:u,description:d,type:f,ordered:p});case 6:r({type:"showSuccessToast",key:"editCollection",message:'Collection "'.concat(l,'" edited.')}),s.default.replace(s.default.asPath),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),r({type:"showErrorToast",key:"editCollection",message:'Oops, Editing collection "'.concat(l,'" failed. Try again?')});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),h=function(){var e=f(o().mark((function e(t,n,r){var c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.collection,l=c.id,r({type:"showProcessingToast",key:"deleteCollection",message:"Deleting collection\u2026"}),e.prev=3,e.next=6,(0,i.Fv)("/collection/".concat(l,"/delete"));case 6:r({type:"showSuccessToast",key:"deleteCollection",message:"Collection deleted successfully!."}),s.default.replace((0,a.$2)(c.owner)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),r({type:"showErrorToast",key:"deleteCollection",message:"Oops, deleting collection failed. Try again?"});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),v=function(){var e=f(o().mark((function e(t,n,r){var c,l,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.collection,l=n.thumbnail,a=c.title,u=c.id,r({type:"showProcessingToast",key:"setCollectionThumbnail",message:"Setting thumbnail for ".concat(a,"\u2026")}),e.prev=3,e.next=6,(0,i.Fv)("/collection/".concat(u,"/thumbnail"),{thumbnail:l||null});case 6:r({type:"showSuccessToast",key:"setCollectionThumbnail",message:'Collection "'.concat(a,'" thumbnail set.')}),s.default.replace(s.default.asPath),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),r({type:"showErrorToast",key:"setCollectionThumbnail",message:"Oops, setting thumbnail failed. Try again?"});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),g=function(){var e=f(o().mark((function e(t,n,r){var l,a,u,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.currentUser,a=n.addTo,u=n.removeFrom,d=n.onDismiss,f=n.collectionId,e.next=3,Promise.allSettled(p(a.map((function(e){return(0,i.Fv)("/collection/".concat(e.id,"/add"),{collection_listing_id:f})}))).concat(p(u.map((function(e){return(0,i.Fv)("/collection/".concat(e.id,"/remove"),{collection_listing_id:f})})))));case 3:e.sent.some((function(e){return"fulfilled"!==e.status}))?r({type:"showErrorToast",message:"Oops, collections update failed. Try again?",key:"collections"}):(a.forEach((function(e){return(0,c.MR)((0,c.y6)({type:"collection:manage:addCollectionListing",data:{addedListingId:f},collection:e,currentUser:l,eventVersion:1}))})),u.forEach((function(e){return(0,c.MR)((0,c.y6)({type:"collection:manage:removeCollectionListing",data:{removedListingId:f},collection:e,currentUser:l,eventVersion:1}))}))),s.default.replace(s.default.asPath),d();case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),b=n(17152);function x(e,t,n,r,o,i,c){try{var l=e[i](c),a=l.value}catch(s){return void n(s)}l.done?t(a):Promise.resolve(a).then(r,o)}var w={forkRequested:function(){var e,t=(e=o().mark((function e(t,n,r){var i,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.notebook,c=t.currentUser,!i.isForking){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,b.Fe)(c,i,n,r);case 5:(l=e.sent)?(r({type:"showSuccessToast",message:"Notebook forked to ".concat(l.owner.login),key:"fork"}),r({type:"forkSucceeded",id:l.id})):r({type:"forkFailed"});case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){x(i,r,o,c,l,"next",e)}function l(e){x(i,r,o,c,l,"throw",e)}c(void 0)}))});return function(e,n,r){return t.apply(this,arguments)}}(),createCollection:m,editCollection:y,deleteCollection:h,setCollectionThumbnail:v,updateCollectionInCollections:g}},77180:function(e,t,n){n.d(t,{L:function(){return r}});var r={selectNotebook:function(e,t){return t.notebook}}}}]);
