"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9168],{79209:function(e,t,n){var r=n(85893);n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.Z=function(e){return(0,r.jsxs)("svg",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){i(e,t,n[t])}))}return e}({width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"},e,{children:[(0,r.jsx)("circle",{cx:"8",cy:"8",r:"8"}),(0,r.jsx)("path",{d:"M6.87036 3.5L7.05786 9.18359H8.93286L9.12036 3.5H6.87036ZM7.99536 12.1602C8.75122 12.1602 9.19653 11.7676 9.19653 11.0938C9.19653 10.4141 8.75122 10.0215 7.99536 10.0215C7.2395 10.0215 6.80005 10.4141 6.80005 11.0938C6.80005 11.7676 7.2395 12.1602 7.99536 12.1602Z",fill:"white"})]}))}},73626:function(e,t,n){var r=n(85893);n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.Z=function(e){return(0,r.jsx)("svg",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){i(e,t,n[t])}))}return e}({width:"8",height:"16",viewBox:"0 0 8 16",fill:"none"},e,{children:(0,r.jsx)("path",{d:"M2.98713 12.6H5.00005V6H2.98713V12.6ZM4 5.16211C4.60352 5.16211 5.10156 4.6875 5.10156 4.08398C5.10156 3.48047 4.60352 3 4 3C3.39648 3 2.89844 3.48047 2.89844 4.08398C2.89844 4.6875 3.39648 5.16211 4 5.16211Z",fill:"currentColor"})}))}},88184:function(e,t,n){n.d(t,{b:function(){return Qt},R:function(){return Xt}});var r=n(93452),i=n(3222),o=n(85893),a=n(56424),s=n(27565),l=n(28041),c=n(602),u=n(19671),d=n(4598),m=n(41664),h=n(67294),f=n(4242),v=n(37497),p=n(11233),b=n(33090),y=n(74878),g=n(19868),x=n(22027),j=n(2845),w=n(60138),_=n(22513),S=n(44754),k=n(18582),N=n(47743),C=n(11342),T=n(40821),O=n(20958);function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){I(e,t,n[t])}))}return e}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){if(e){if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}var R=function(e){var t=e.title,n=e.className,r=void 0===n?"":n;return(0,o.jsx)("div",{className:"".concat(r," f6 fw4 mid-gray mt3 mb2"),children:t})},M=function(){return(0,o.jsxs)("div",{className:"mv2 flex items-center mid-gray",children:[(0,o.jsx)(x.Z,{className:"blue mr2"}),"Loading\u2026"]})},U=function(){return(0,o.jsx)("div",{className:"mv2 mid-gray fw4 f7",children:"\xa0\xa0No files found"})},V=function(e){var t=e.type,n=void 0===t?"files":t;return(0,o.jsxs)("div",{className:"mv2 flex items-center mid-gray",children:[(0,o.jsx)(_.Z,{className:"red mr2"}),"We encountered an error fetching your ",n,"."]})},Z=function(e){var t=e.id,n=e.name,r=e.file,i=e.folder,a=e.driveId,s=e.breadcrumb,l=e.parentReference,c=e.onFolderSelect,u=(null===r||void 0===r?void 0:r.mimeType)||(0,C.Le)(n);return r?(0,o.jsxs)("div",{className:"flex items-center fw6 near-black",children:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===u?(0,o.jsx)(j.i6,{className:"mr2"}):"application/vnd.openxmlformats-officedocument.presentationml.presentation"===u?(0,o.jsx)(j.Ob,{className:"mr2"}):"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===u?(0,o.jsx)(j.Bl,{className:"mr2"}):"application/msonenote"===u?(0,o.jsx)(j.hG,{className:"mr2"}):(0,o.jsx)(j.$B,{className:"mr2 mid-gray"}),(null===s||void 0===s?void 0:s.id)!==(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l?void 0:l.name)&&(0,o.jsxs)(o.Fragment,{children:[l.name,"\xa0/\xa0"]}),n||"File"]}):i?(0,o.jsxs)("button",{className:"flex justify-between items-center w-100 b--transparent bg-transparent pointer hover-bg-near-white",onClick:function(){return c({id:t,driveId:a,name:n||"Folder"})},children:[(0,o.jsxs)("div",{className:"flex items-center fw6 near-black",children:[(0,o.jsx)(j.gt,{className:"mr2"}),n]}),(0,o.jsx)(y.Z,{})]}):null},q=function(e){var t=e.accessToken,n=e.includeGroups,r=e.onSelect,i=(0,T.ZP)(t?["/microsoft/drives",t,n]:null,C.Z8,{revalidateOnFocus:!1}),a=i.data,s=i.error;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(R,{title:"Drives"}),s?(0,o.jsx)(V,{type:"drives"}):a?a.map((function(e){var t,n,i=(null===(t=e.owner)||void 0===t?void 0:t.user)?"Personal":"Team";return e.id?(0,o.jsxs)("button",{className:"pv2 fw6 near-black flex items-center justify-between w-100 b--transparent bg-transparent pointer hover-bg-near-white",onClick:function(){return r({id:e.id,name:e.name||i})},children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(null===(n=e.owner)||void 0===n?void 0:n.user)?(0,o.jsx)(j.t3,{className:"mr2"}):(0,o.jsx)(j.pd,{className:"mr2"}),(0,o.jsx)("span",{className:"mr1",children:e.name||"My files"}),(0,o.jsx)("span",{className:"gray",children:"\u2022"}),(0,o.jsx)("span",{className:"ml1 f45 gray",children:i})]}),(0,o.jsx)(y.Z,{})]},e.id):null})):(0,o.jsx)(M,{})]})},L=function(e){var t=e.path,n=e.title,r=e.breadcrumbs,i=e.driveId,a=e.accessToken,s=e.onFolderSelect,l=e.onFileSelect,c=e.onLoadMore,u=(0,O.ZP)((0,C.mL)(t,a),(function(e){return(0,k.r)(e,a)}),{revalidateOnFocus:!1}),d=u.data,m=u.error,f=u.isValidating,p=u.size,y=u.setSize,g=d&&1===d.length&&!d[0].value.length,x=r.length?r[r.length-1]:null;return(0,o.jsxs)(o.Fragment,{children:[r.length?(0,o.jsxs)("div",{className:"f7 gray mv2",children:[(0,o.jsx)("span",{children:"All drives"}),r.map((function(e){return(0,o.jsxs)(h.Fragment,{children:[(0,o.jsx)("span",{className:"mh1",children:"/"}),(0,o.jsx)("span",{children:e.name})]},e.id)}))]}):null,i?null:(0,o.jsx)(R,{title:n}),m?(0,o.jsx)(V,{}):d?g?(0,o.jsx)(U,{}):(0,o.jsxs)(o.Fragment,{children:[d.map((function(e){return e.value.map((function(e){var t,n,r,a=e.remoteItem||e,c=a.id,u=a.file,d=a.folder,m=i||(null===(t=e.remoteItem)||void 0===t||null===(n=t.parentReference)||void 0===n?void 0:n.driveId)||(null===(r=e.parentReference)||void 0===r?void 0:r.driveId);return u&&c&&m?(0,o.jsx)(b.E,{className:"pl2 mv3",name:"selected_file",onClick:function(){return l({path:"/drives/".concat(m,"/items/").concat(c),name:e.name,mimeType:u.mimeType||(0,C.Le)(e.name),size:e.size})},label:(0,o.jsx)(Z,D({},e,{file:u,id:c,driveId:i,onFolderSelect:s,breadcrumb:x}))},"/".concat(m,"/").concat(c)):d&&c&&m?(0,o.jsx)("div",{className:"mv3",children:(0,h.createElement)(Z,D({},e,{key:"/".concat(m,"/").concat(c),folder:d,id:c,driveId:i,onFolderSelect:s,breadcrumb:x}))}):null}))})),r.length&&d.length&&d[d.length-1]["@odata.nextLink"]?(0,o.jsx)(v.aX,{onClick:function(){y(p+1),c()},text:"Load more",loading:p>1&&f,colorless:!0}):null]}):(0,o.jsx)(M,{})]})};function z(e){var t=e[e.length-1];return t.driveId?"/drives/".concat(t.driveId,"/items/").concat(t.id,"/children?$top=5"):"/drives/".concat(t.id,"/root/children?$top=5")}var $=(0,f.$j)((function(e){return{notebook:e.notebook,currentUser:e.currentUser}}),(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,n=e.onDismiss,i=e.notebook,s=e.currentUser,l=function(e){y(null),_(P(x).concat([e])),(0,u.MR)((0,u.ym)({type:"notebook:view:cloudFileFolder",notebook:i,currentUser:s,data:{provider:"microsoftData"},eventVersion:1}))},d=function(){(0,u.MR)((0,u.ym)({type:"notebook:view:cloudFileLoadMore",notebook:i,currentUser:s,data:{provider:"microsoftData"},eventVersion:1}))},m=F((0,c.h_)("/user/token?provider=microsoftData"),1)[0],f=(0,h.useState)(null),b=f[0],y=f[1],g=(0,h.useState)([]),x=g[0],_=g[1],k=F((0,S.G)(""),3),N=k[0],C=k[1],T=k[2],O=T.trim().replace(/[{}']/g,""),A=(0,h.useRef)(!1);return(0,h.useEffect)((function(){T&&!A.current&&(A.current=!0,(0,u.MR)((0,u.ym)({type:"notebook:view:cloudFileSearch",data:{provider:"microsoftData"},notebook:i,currentUser:s,eventVersion:1})))}),[i,s,T]),(0,o.jsxs)(a.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:[(0,o.jsx)(r.xB,{title:"Connect Microsoft file",icon:j.ZP,onDismiss:n}),(0,o.jsxs)(r.fe,{maxHeight:475,children:[!x.length&&(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(w.Z,{className:"absolute gray mh1 mt2"}),(0,o.jsx)(p.Z,{autoComplete:"false",spellCheck:!1,onChange:function(e){return C(e.target.value)},className:"ph4 pv2 border-box w-100",type:"search",placeholder:"Search",value:N,maxLength:128,size:0})]}),!x.length&&T?(0,o.jsx)(L,{title:"Search Results",accessToken:null===m||void 0===m?void 0:m.access_token,path:"/me/drive/search(q='{".concat(encodeURIComponent(O),"}')"),breadcrumbs:x,onFileSelect:y,onFolderSelect:l,onLoadMore:d}):x.length?(0,o.jsx)(L,{path:z(x),title:x[x.length-1].name,breadcrumbs:x,onFolderSelect:l,accessToken:null===m||void 0===m?void 0:m.access_token,onFileSelect:y,onLoadMore:d,driveId:x[x.length-1].driveId||x[x.length-1].id}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(q,{onSelect:l,accessToken:null===m||void 0===m?void 0:m.access_token,includeGroups:!!(null===m||void 0===m?void 0:m.provider_org)}),(0,o.jsx)(L,{path:"/me/drive/recent?$top=5",title:"Recently edited",breadcrumbs:x,onFolderSelect:l,onFileSelect:y,onLoadMore:d,accessToken:null===m||void 0===m?void 0:m.access_token}),(0,o.jsx)(L,{path:"/me/drive/sharedWithMe?$top=5",title:"Shared with me",breadcrumbs:x,onFolderSelect:l,onFileSelect:y,onLoadMore:d,accessToken:null===m||void 0===m?void 0:m.access_token})]})]}),(0,o.jsx)(r.mz,{children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)(v.aX,{text:"Back",onClick:function(){x.length?(y(null),_(x.slice(0,x.length-1))):t({type:"showModal",modal:"addCloudFile"})}}),(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{text:"Cancel",onClick:n}),(0,o.jsx)(v.KM,{text:"Connect",disabled:!b,onClick:function(){n(),t(D({type:"insertCloudFile",provider:"microsoftData"},b))}})]})]})})]})})),B=!1,K=!1,X=(0,f.$j)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,n=e.onDismiss,i=F((0,c.h_)("/user/token?provider=googleData"),1)[0],l=i&&d.c.googleData.scopes.every((function(e){return i.scopes.includes(e)})),u=(0,h.useState)(K),m=u[0],f=u[1];K||B||(B=!0,(0,N.__)().then((function(e){return e.load("picker",{callback:function(){return f(K=!0)}})})));var p=(0,h.useCallback)((function(e){switch(e.action){case google.picker.Action.PICKED:var r=e.docs[0].id;n(),t({type:"insertCloudFile",provider:"googleData",path:"/drive/v3/files/".concat(r),name:e.docs[0].name,mimeType:(0,N.SW)(e.docs[0].mimeType)||"text/plain"});break;case google.picker.Action.CANCEL:n()}}),[n,t]);return(0,h.useEffect)((function(){if(m&&i&&l){var e=(new google.picker.PickerBuilder).addView((new google.picker.DocsView).setOwnedByMe(!0)).addView(new google.picker.DocsView(google.picker.ViewId.SPREADSHEETS)).addView((new google.picker.DocsView).setIncludeFolders(!0)).enableFeature(google.picker.Feature.SUPPORT_DRIVES).setAppId(N.eJ).setCallback(p).setDeveloperKey(N.N6).setOAuthToken(i.access_token).build();return e.setVisible(!0),function(){return e.dispose()}}}),[m,l,i,p]),i&&!l?(0,o.jsxs)(a.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:[(0,o.jsx)(r.xB,{title:"Grant additional access",icon:g.Z,onDismiss:n}),(0,o.jsxs)(r.fe,{children:["Observable still needs the following permission to access your files. Please grant access on the next page.",(0,o.jsx)("div",{className:"flex justify-center mv3",children:(0,o.jsxs)("div",{className:"ba b--light-gray bg-near-white br2 pa1 flex items-center",children:[(0,o.jsx)(g.v,{className:"mr2"}),"See and download all your Google Drive files"]})})]}),(0,o.jsx)(r.mz,{children:(0,o.jsx)(s.E,{provider:"googleData",alreadyAuthenticated:!!i.access_token,redirectToPicker:!0,children:(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{text:"Cancel",onClick:n}),(0,o.jsx)(v.KM,{text:"Continue",type:"submit"})]})})})]}):null}));function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=function(e){var t=e.dispatch,n=e.provider,r=e.token,i=e.onAuth,a=e.info,l=a.name,c=a.icon;return(0,o.jsx)(s.E,{provider:n,alreadyAuthenticated:!!r,onAuth:i,redirectToPicker:!0,children:(0,o.jsxs)("div",{className:"flex justify-between items-center mv2",children:[(0,o.jsxs)("div",{className:"near-black flex items-center",children:[(0,o.jsx)(c,{className:"mr2 w2 h2"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"fw6",children:l}),r?(0,o.jsxs)("div",{className:"f7",children:[(0,o.jsx)("span",{className:"mid-gray mr1",children:r.provider_username}),(0,o.jsx)("button",{className:"blue pointer underline-hover bg-transparent pa0 bn",type:"submit",children:"Switch account"})]}):null]})]}),r?(0,o.jsx)(v.aX,{text:"Continue",type:"button",colorless:!0,onClick:function(){return t({type:"showModal",modal:"cloudFile",modalProps:{provider:n}})}}):(0,o.jsx)(v.aX,{text:"Connect",colorless:!0,type:"submit"})]})})},Y=(0,f.$j)((function(e){return{currentUser:e.currentUser,notebook:e.notebook}}),(function(e){return{dispatch:e}}))((function(e){var t=e.onDismiss,n=e.dispatch,i=e.notebook,s=e.currentUser,h=function(e){(0,u.MR)((0,u.ym)({type:"notebook:manage:cloudFileAuth",notebook:i,currentUser:s,data:{provider:e,alreadyAuthenticated:!1},eventVersion:1}))},f=J((0,c.h_)("/user/tokens"),1)[0];return(0,o.jsxs)(a.Vq,{onDismiss:t,"aria-labelledby":"modal-title",children:[(0,o.jsx)(r.xB,{icon:l.Z,title:"Add cloud file",onDismiss:t}),(0,o.jsxs)(r.fe,{children:[(0,o.jsx)(R,{title:"Available integrations"}),Object.entries(d.c).map((function(e){var t=J(e,2),r=t[0],i=t[1];return(0,o.jsx)(W,{dispatch:n,token:f?f.find((function(e){return e.provider===r})):void 0,provider:r,info:i,onAuth:h},r)})),(0,o.jsxs)("div",{className:"mt4",children:["You can manage the apps you\u2018ve granted permission to in your"," ",(0,o.jsx)(m.default,{href:"/settings/oauth-tokens",children:(0,o.jsx)("a",{className:"blue",children:"settings"})}),"."]})]}),(0,o.jsx)(r.mz,{children:(0,o.jsx)(v.CQ,{children:(0,o.jsx)(v.aX,{text:"Cancel",onClick:t})})})]})})),H=n(3764),G=n(84193),ee=n(27193),te=n(25655),ne=n(47692),re=n(36448);function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ae=(0,f.$j)((function(e){return{notebook:e.notebook}}),(function(e){return{dispatch:e}}))((function(e){var t=e.notebook,n=e.dispatch,i=e.onDismiss,s=t.owner,l=t.model.nodes,u=oe((0,c.h_)("".concat((0,te.p0)(t)?"/team/".concat(s.id):"/user","/data-connectors?detail=false")),1)[0],d=void 0===u?[]:u,m=(0,ne.Z)(l).databaseClients,f=d.filter((function(e){return!m.has(e.name)})),p=(0,h.useState)(f.length?f[0].name:""),y=p[0],g=p[1];return(0,o.jsxs)(a.Vq,{onDismiss:i,"aria-labelledby":"modal-title",children:[(0,o.jsx)(r.xB,{title:"Add database",icon:H.Z,onDismiss:i}),(0,o.jsxs)(r.fe,{children:[(0,o.jsxs)("div",{className:"mv3",children:["Select from"," ",(0,te.p0)(t)?"".concat((0,ee.KY)(s),"\u2019s"):"your"," ","databases below or"," ",(0,o.jsx)(G.Z,{href:"".concat((0,re.rF)(s),"/databases?new"),children:(0,o.jsx)("a",{className:"blue",children:"configure a new database"})}),"."]}),d.length?d.map((function(e){return(0,o.jsx)(b.E,{name:"database",label:e.name,icon:H.t,description:(0,o.jsxs)(o.Fragment,{children:[m.has(e.name)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"blue fw6",children:"In use"}),(0,o.jsx)("span",{className:"light-gray",children:" \u2022 "})]}):"",(0,ee.Zb)(e.type)]}),onChange:function(){return g(e.name)},checked:y===e.name,disabled:m.has(e.name)},e.name)})):(0,o.jsxs)("div",{className:"mid-gray",children:[(0,te.p0)(t)?"".concat((0,ee.KY)(s)," doesn\u2019t"):"You don\u2019t"," ","have any databases yet."]})]}),(0,o.jsx)(r.mz,{children:(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{onClick:i,text:"Cancel"}),(0,o.jsx)(v.KM,{onClick:function(){i(),n({type:"insertDatabase",name:y})},text:"Confirm"})]})})]})})),se=n(8385),le=n(79209),ce=n(71675),ue=n(75872),de=n(1099),me=n(81685),he=n(8433),fe=n(42568),ve=n(75713),pe=n(20042);function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ye(e,t,n[t])}))}return e}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||we(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||we(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){if(e){if("string"===typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function _e(e){var t=e.id,n=e.login,r=e.name;return{avatar_url:e.avatar_url,login:n,name:r||n,bio:"",home_url:"",id:t,github_login:null}}var Se=function(e){var t=e.notebook,n=e.dispatch,i=e.onDismiss,s=e.teamMemberIds,l=e.teamId,c=function(e,t){var n=b.findIndex((function(t){return t.id===e.id}));if(n>-1&&n+t>=0&&n+t<b.length){var r=b.slice(0);r.splice(n,1),r.splice(n+t,0,b[n]),y(r)}},u=t.authors,d=t.owner,m=(0,h.useState)(u)[0],f=(0,h.useState)(u),b=f[0],y=f[1],g=(0,h.useState)(null),x=g[0],j=g[1],w=m===b;return(0,o.jsx)(a.Vq,{onDismiss:i,"aria-labelledby":"modal-title",children:(0,o.jsxs)(ve.l,{className:"f6 lh-copy",onSubmit:function(e){i(),n({type:"setAuthors",authors:b}),e.preventDefault()},children:[(0,o.jsx)(r.xB,{title:"Authors",icon:me.Z,onDismiss:i}),(0,o.jsxs)(r.fe,{children:[(0,o.jsxs)("div",{children:["team"===d.type&&(0,o.jsxs)("div",{className:"flex items-center justify-between pb3 mb2 bb b--light-gray",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(se.q,{user:d,size:28,className:"br-100 mr2"}),(0,o.jsx)("span",{className:"fw6 mr2",children:d.name}),(0,o.jsxs)("span",{className:"mid-gray",children:["@",d.login]})]}),(0,o.jsx)("span",{className:"fw5 mid-gray",children:"Team Owner"})]}),0===b.length&&(0,o.jsx)("div",{className:"mid-gray mb3",children:"No individual authors."}),b.map((function(e,t){return(0,o.jsxs)("div",{className:"flex items-start ".concat(t?"pt2 bt b--light-gray":""),children:[(0,o.jsxs)("div",{className:"flex pr2",children:[(0,o.jsx)(v.hU,{colorless:!0,icon:ue.Z,disabled:!t,onClick:function(){return c(e,-1)}}),(0,o.jsx)(v.hU,{colorless:!0,icon:ce.Z,disabled:t===b.length-1,onClick:function(){return c(e,1)}})]}),(0,o.jsxs)("div",{className:"flex-auto",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between pb2",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(se.q,{user:e,size:28,className:"br-100 mr2"}),(0,o.jsx)("span",{className:"fw6 mr2",children:e.name}),(0,o.jsxs)("span",{className:"mid-gray",children:["@",e.login]})]}),e.id===d.id?(0,o.jsx)("span",{className:"fw5 mid-gray",children:"Owner"}):(0,o.jsxs)("div",{className:"flex items-center",children:[!e.approved&&(0,o.jsxs)("span",{className:"yellow fw5 flex items-center mr2 tooltipped tooltipped-n","aria-label":"".concat((null===s||void 0===s?void 0:s.size)?"Because they are outside your team, ":"").concat(e.name," ").concat(u.some((function(t){return t.id===e.id}))?"has been":"will be"," invited to be an author by email"),children:[(0,o.jsx)(le.Z,{className:"mr1"})," ",u.some((function(t){return t.id===e.id}))?"Invited":"Invite"]}),(0,o.jsxs)(fe.v2,{children:[(0,o.jsx)(v.hU,{colorless:!0,asMenuButton:!0,icon:de.v}),(0,o.jsx)(fe.qy,{children:(0,o.jsxs)(fe.sN,{onSelect:function(){return function(e){var t=b.findIndex((function(t){return t.id===e.id}));t>-1&&y(je(b.slice(0,t)).concat(je(b.slice(t+1))))}(e)},children:[(0,o.jsx)(he.Z,{className:"mr1"})," Remove author"]})})]})]})]}),b.length>1&&(0,o.jsx)("div",{className:"pb3",children:(0,o.jsx)(p.Z,{placeholder:"Author role (optional)",value:e.description,maxLength:255,onChange:function(t){return function(e,t){var n=b.findIndex((function(t){return t.id===e.id}));n>-1&&y(je(b.slice(0,n)).concat([ge({},b[n],{description:t})],je(b.slice(n+1))))}(e,t.target.value)},className:"w-100"})})]})]},e.id)}))]}),(0,o.jsxs)("div",{className:"flex items-center pt3 ".concat(b.length?"bt b--light-gray":""),children:[(0,o.jsx)(pe.o,{value:x,className:"w-100 mr3",excluded:b.map(_e),placeholder:"Author @username",onSelectUser:function(e){return j(e)},teamId:l}),(0,o.jsx)(v.aX,{text:"Add",onClick:function(){var e,t;null===x||"invited"in x||(-1===b.findIndex((function(e){return e.id===x.id}))&&y(je(b).concat([(e=x,t=(null===s||void 0===s?void 0:s.has(x.id))||!1,{id:e.id,login:e.login,name:e.name,avatar_url:e.avatar_url,bio:e.bio,home_url:e.home_url,github_login:e.github_login,approved:t,description:""})])),j(null))},disabled:!x})]})]}),(0,o.jsx)(r.mz,{children:(0,o.jsx)("div",{className:"flex justify-end",children:(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{text:"Cancel",onClick:i}),(0,o.jsx)(v.KM,{type:"submit",text:"Confirm",disabled:w})]})})})]})})},ke=(0,f.$j)((function(e){return{notebook:e.notebook,currentUser:e.currentUser}}),(function(e){return{dispatch:e}}))((function(e){var t=e.notebook,n="team"===t.owner.type,r=xe((0,c.h_)(n?"/team/".concat(t.owner.id,"/members"):null),1)[0],i=(0,h.useMemo)((function(){return new Set(null===r||void 0===r?void 0:r.map((function(e){return e.id})))}),[r]);return!n||r?(0,o.jsx)(Se,ge({},e,{teamMemberIds:i,teamId:n?t.owner.id:void 0})):null})),Ne=(0,f.$j)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,n=e.onDismiss,i=e.trigger,a=e.source;return(0,o.jsx)(r.On,{title:"Close suggestion",icon:he.Z,description:"Are you sure you want to close this suggestion?",onCancel:n,onConfirm:function(){n(),t({type:"closeSuggestion",trigger:i,source:a})},destructive:!0})})),Ce=(0,f.$j)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.comment,n=e.dispatch,i=e.onDismiss;return(0,o.jsx)(r.On,{title:"Delete comment",icon:he.Z,description:"Are you sure you want to delete this comment? This action cannot be undone.",onCancel:i,onConfirm:function(){i(),n({type:"commentDeleted",comment:t,trigger:"click",source:"commentIcon"})},destructive:!0})})),Te=(0,f.$j)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.name,n=e.dispatch,i=e.onDismiss;return(0,o.jsx)(r.On,{title:"Delete file",icon:he.Z,description:(0,o.jsxs)(o.Fragment,{children:["Are you sure you want to delete ",(0,o.jsxs)("b",{children:["\u201c",t,"\u201d"]}),"? Versions of this notebook which reference this file will no longer work."]}),onCancel:i,onConfirm:function(){i(),n({type:"fileMarkedForDeletion",name:t})},destructive:!0})})),Oe=n(93314),Ae=n(58171),Ie=n(64804),De=n(96386),Fe=n(88725),Pe=n(72760),Ee=n(45219),Re=n(34051),Me=n.n(Re),Ue=n(23869);function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}function Le(e,t){return t?t>0?Le("  "+e,t-1):Le(e.replace(/^ {2}/,""),t+1):e}function ze(e,t){return e.split("\n").map((function(e){return Le(e,t)})).join("\n")}function $e(e){var t=e.entire,n=e.names,r=e.notebookUrl,i=e.preview,o=e.uiOrigin,a=new URLSearchParams,s=i?"/embedpreview":"/embed";t?a.append("cell","*"):n&&0!==n.length?a.append("cells",n.join(",")):a.append("cell","no-cells");var l=r.startsWith("/d")?r.slice(2):r;return"".concat(o).concat(s).concat(l,"?").concat(a)}function Be(e){var t=e.entire,n=e.names,r=e.notebookUrl,i=e.height,o=$e({uiOrigin:e.uiOrigin,preview:e.preview,entire:t,names:n,notebookUrl:r});return'<iframe width="100%" height="'.concat(i,'" frameborder="0"\n  src="').concat(o,'"></iframe>')}var Ke=function(e){var t=e.title,n=e.owner,r=e.notebookUrl,i=e.uiOrigin;return'<p>Credit: <a href="'.concat(i+r,'">').concat(qe(t)," by ").concat(qe(n+""),"</a></p>")};function Xe(e){var t,n,r=e.entire,i=e.names,o=e.notebookUrl,a=e.moduleUrl,s=e.title,l=e.owner,c=e.uiOrigin,u=e.runSelection,d=e.randomId;return r?(t='<div id="observablehq-'.concat(d,'"></div>'),n='new Runtime().module(define, Inspector.into("#observablehq-'.concat(d,'"));')):(t=i.map((function(e){return'<div id="'.concat(Je(e,d),'"></div>')})).join("\n"),n="new Runtime().module(define, name => {\n".concat(i.map((function(e){return'  if (name === "'.concat(e,'") return new Inspector(document.querySelector("#').concat(Je(e,d),'"));\n')})).join("")).concat(u.length?"  return ".concat(JSON.stringify(u),".includes(name);\n"):"","});")),"".concat(t,"\n").concat(Ke({title:s,owner:l,notebookUrl:o,uiOrigin:c}),'\n\n<script type="module">\nimport {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";\nimport define from "').concat(a,'";\n').concat(n,"\n<\/script>")}function Qe(e){var t,n,r,i=e.entire,o=e.slug,a=e.names,s=e.notebookUrl,l=e.runSelection,c=e.title,u=e.owner,d=e.uiOrigin,m=function(e){return e?e.replaceAll(/[^-a-zA-Z]/g,"").split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(""):"Notebook"}(o),h=function(e){var t=new Map([["useRef",""]]),n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){for(var s=o.value,l=We(s)+"Ref",c=l,u=1;t.has(c);)c="".concat(l,"$").concat(u++);t.set(c,s)}}catch(d){r=!0,i=d}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return Array.from(t).filter((function(e){return""!==Ze(e,2)[1]}))}(a),f=s.startsWith("/d")?s.slice(3):s.slice(1);return i?(t="const ref = useRef();",n="runtime.module(notebook, Inspector.into(ref.current));",r="<div ref={ref} />"):(t=h.map((function(e){var t=Ze(e,1)[0];return"const ".concat(t," = useRef();")})).join("\n"),n="runtime.module(notebook, name => {\n".concat(h.map((function(e){var t=Ze(e,2),n=t[0],r=t[1];return'  if (name === "'.concat(r,'") return new Inspector(').concat(n,".current);")})).join("\n"),"\n").concat(l.length?"  return ".concat(JSON.stringify(l),".includes(name);\n"):"","});"),r=h.map((function(e){var t=Ze(e,1)[0];return"<div ref={".concat(t,"} />")})).join("\n")),'import React, {useRef, useEffect} from "react";\nimport {Runtime, Inspector} from "@observablehq/runtime";\nimport notebook from "'.concat(f,'";\n\nfunction ').concat(m,"() {\n").concat(ze(t,1),"\n\n  useEffect(() => {\n    const runtime = new Runtime();\n").concat(ze(n,2),"\n    return () => runtime.dispose();\n  }, []);\n\n  return (\n    <>\n").concat(ze(r,3),"\n").concat(ze(Ke({title:c,owner:u,notebookUrl:s,uiOrigin:d}),3),"\n    </>\n  );\n}\n\nexport default ").concat(m,";")}function Je(e,t){return"observablehq-".concat(e.replace(/ /g,"-"),"-").concat(t)}function We(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function He(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,i)}function Ge(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){He(o,r,i,a,s,"next",e)}function s(e){He(o,r,i,a,s,"throw",e)}a(void 0)}))}}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){et(e,t,n[t])}))}return e}function nt(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function rt(e){return function(e){if(Array.isArray(e))return Ye(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ye(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var it=function(e){var t=e.text,n=e.onCopy,r=e.url,i=(0,h.useRef)(null),a=(0,h.useRef)(null),s=(0,h.useState)(!1),l=s[0],c=s[1],u=(0,h.useState)(!1),d=u[0],m=u[1],f=(0,h.useState)(null),p=f[0],b=f[1];return(0,h.useEffect)((function(){var e;if(p&&a.current){a.current.focus(),(e=a.current).setSelectionRange.apply(e,rt(p));var t=setTimeout((function(){var e;null===(e=a.current)||void 0===e||e.setSelectionRange(null,null),b(null)}),250);return function(){return clearTimeout(t)}}}),[p,t]),(0,o.jsxs)("div",{ref:i,children:[(0,o.jsx)("textarea",{ref:a,readOnly:!0,rows:Math.min(t.split("\n").length,10),className:"w-100 ph2 pv1 mt2 code f7 pre dark-gray hover-near-black bg-near-white br2 lh-f7 form-default-clear form-custom-input",style:{resize:"none",overflow:"auto"},value:t,onCopy:function(){return n&&n()}}),(0,o.jsxs)(v.CQ,{className:"mt3",children:[r&&(0,o.jsx)(v.kq,{text:"Copy URL only",icon:d?Ue.Z:Ie.Z,onClick:Ge(Me().mark((function e(){var i;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(r);case 2:m(!0),i=t.indexOf(r),b([i,i+r.length]),n&&n();case 6:case"end":return e.stop()}}),e)})))}),(0,o.jsx)(v.KM,{text:"Copy",icon:l?Ue.Z:Ie.Z,onClick:Ge(Me().mark((function e(){return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(t);case 2:c(!0),b([0,t.length]),n&&n();case 5:case"end":return e.stop()}}),e)})))})]})]})},ot=function(e){var t=e.onCopy,n=nt(e,["onCopy"]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"mt2 mb1 f7 dark-gray lh-copy",children:"This HTML tag works almost anywhere and preserves the styles of your original notebook."}),(0,o.jsx)(it,{text:Be(n),url:$e(n),onCopy:function(){return t("Iframe")}})]})},at=function(e){var t=e.onCopy,n=nt(e,["onCopy"]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"mt2 mb1 f7 dark-gray lh-copy",children:["This code uses the"," ",(0,o.jsx)("a",{className:"no-underline blue hover-dark-blue link",href:"/@observablehq/downloading-and-embedding-notebooks",target:"_blank",rel:"noopener noreferrer",children:"Runtime API"})," ","in plain JavaScript to make cells a native part of your website, where they can be rearranged and will inherit the surrounding styles."]}),(0,o.jsx)(it,{text:Xe(n),onCopy:function(){return t("JavaScript")}})]})},st=function(e){var t=e.onCopy,n=e.hasFiles,r=e.packageUrl,i=nt(e,["onCopy","hasFiles","packageUrl"]);return(0,o.jsxs)("div",{className:"mt2 mb1 f7 dark-gray lh-copy",children:["This code uses the"," ",(0,o.jsx)("a",{className:"no-underline blue hover-dark-blue link",href:"/@observablehq/downloading-and-embedding-notebooks",target:"_blank",rel:"noopener noreferrer",children:"Runtime API"})," ","to generate a React component. From the terminal, run:",(0,o.jsx)(it,{text:'yarn add @observablehq/runtime@4\nyarn add "'.concat(r,'"')}),(0,o.jsx)("div",{className:"mt2",children:"Then copy and paste the following component into your application:"}),(0,o.jsx)(it,{text:Qe(i),onCopy:function(){return t("React")}}),n&&(0,o.jsxs)("div",{className:"mt2",children:["This notebook uses file attachments, which may require a workaround to work with a bundler like Babel; see"," ",(0,o.jsx)("a",{className:"no-underline blue hover-dark-blue link",href:"/@observablehq/troubleshooting-embedding",target:"_blank",rel:"noopener noreferrer",children:"Troubleshooting"}),"."]})]})},lt=function(e){var t=e.width,n=e.height,r=nt(e,["width","height"]);return(0,o.jsx)("iframe",{title:"Embed preview",src:$e(r),frameBorder:"0",className:"db bg-white shadow-4",style:{width:t,height:n}})},ct=function(e){var t=e.width,n=e.height,r=nt(e,["width","height"]);return n=n+34+16,(0,o.jsx)("iframe",{title:"Embed preview",src:$e(tt({},r,{preview:!0})),frameBorder:"0",className:"db bg-white shadow-4",style:{width:t,height:n}})},ut=[{name:"Iframe",content:function(e){return{instructions:(0,o.jsx)(ot,tt({},e)),preview:(0,o.jsx)(lt,tt({},e))}}},{name:"Runtime with JavaScript",content:function(e){return{instructions:(0,o.jsx)(at,tt({},e)),preview:(0,o.jsx)(ct,tt({},e))}}},{name:"Runtime with React",content:function(e){return{instructions:(0,o.jsx)(st,tt({},e)),preview:(0,o.jsx)(ct,tt({},e))}}}];function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mt(e){return function(e){if(Array.isArray(e))return dt(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){var n=e.slug,r=e.owner,i=e.id,o=e.saveVersion;return"".concat("https://api.observablehq.com","/").concat((0,te.s9)(e)?"@".concat(r.login,"/").concat(n):"d/".concat(i)).concat((0,te.vS)(e)?"":"@".concat(o),".").concat(t)}function ft(e){var t=e.heights,n=e.model,r=n.nodes,i=n.events,o=e.saveVersion,a=e.publishVersion,s=function(e,t,n){var r=new Map(e.map((function(e){return[e.id,!1]}))),i=!0,o=!1,a=void 0;try{for(var s,l=t.slice(n+1)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;c&&"modify_node"===c.type&&r.set(c.node_id,!0)}}catch(u){o=!0,a=u}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return r}(r,i,o),l=r.map((function(e){var n;return{node:e,name:(0,Pe.nR)(e)||"",height:(null===(n=t.get(e.id))||void 0===n?void 0:n.worker)||0,local:e.id>o,unpublished:null===a||e.id>a,unsaved:!!s.get(e.id),downstream:new Set}}));return function(e,t){var n=new Map(e.map((function(e){return[e.node,e]}))),r=(0,De._n)(t),i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;c.downstream=new Set(mt((0,De.mD)(c.node,r)).map((function(e){return n.get(e)})).filter((function(e){return e.name})))}}catch(u){o=!0,a=u}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}(l,r),l}var vt=(0,f.$j)((function(e){return{notebook:e.notebook}}),(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,n=e.onDismiss,i=e.notebook,s=e.selectedNode,l=(0,te.ly)(i),c=(0,te.ws)(i)&&!(0,te.cg)(i),u=(0,h.useRef)(ft(i)),d=(0,h.useRef)(new Map(u.current.map((function(e){return[e.name,e]})))),m=s&&(0,Pe.nR)(s)||"",f=(0,h.useState)(function(e,t){if(t)return[t];var n=e.filter((function(e){return e.name}));return n.length?[n.reduce((function(e,t){return t.height>e.height?t:e})).name]:[]}(u.current,m)),v=f[0],p=f[1],b=function(e,t){var n=e.map((function(e){return t.current.get(e)})),r=new Set(n);return mt(n.reduce((function(e,t){return t?(t.downstream.forEach((function(t){r.has(t)||e.add(t)})),e):e}),new Set)).map((function(e){return e.name}))}(v,d),y=(0,h.useState)(!v.length),g=y[0],x=y[1],j=(0,h.useState)(ut[0]),w=j[0],S=j[1],k=(0,h.useState)((function(){return(0,Ee.Z)(4)}))[0],N=u.current.filter((function(e){return!e.name})).length,C=u.current.filter((function(e){return e.name})),T=(0,h.useState)(660),O=T[0],A=T[1],I=(0,h.useState)(),D=I[0],F=I[1],P=ht(i,"js?v=3"),E=ht(i,"tgz?v=3"),R=u.current.reduce((function(e,t){var n=t.name,r=t.unsaved;return n&&r?e.add(n):e}),new Set),M=u.current.reduce((function(e,t){var n=t.name,r=t.local;return n&&r?e.add(n):e}),new Set),U=u.current.reduce((function(e,t){var n=t.name,r=t.unpublished;return n&&r?e.add(n):e}),new Set),V=l?"Republish your notebook to embed the latest changes":!(!M.size&&!R.size)&&"Fork this notebook to embed with your changes",Z=g||!v.length?500:59+v.reduce((function(e,t){var n;return e+17+((null===(n=d.current.get(t))||void 0===n?void 0:n.height)||0)}),0),q=w.content({entire:g,height:Z,width:O,names:v,runSelection:b,slug:i.slug,title:(0,ee.Ui)(i.model),owner:i.owner.name||i.owner.login,moduleUrl:P,packageUrl:E,notebookUrl:(0,Fe.Bi)(i,i.autosave?void 0:i.saveVersion),uiOrigin:"https://observablehq.com",hasFiles:!!i.files.size,randomId:k,preview:!1,onCopy:function(e){t({type:"embedModalCopy",source:e})}}),L=q.instructions,z=q.preview;return(0,h.useEffect)((function(){var e=function(){var e=window.innerWidth>1400?660:window.innerWidth>1e3?420:0;A(e),F(window.innerWidth>640?e+520:void 0)};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[]),(0,o.jsxs)(a.Vq,{onDismiss:n,"aria-labelledby":"modal-title",className:"flex relative f6 near-black justify-between",style:{width:D,padding:0,maxWidth:D},children:[(0,o.jsxs)("div",{className:"top-0 flex-auto self-start",children:[(0,o.jsx)(r.xB,{title:"Embed",icon:Ie.Z,onDismiss:n}),(0,o.jsxs)("div",{className:"mh3 mb2 dark-gray",children:["Select cells to embed in any web page."," ",(0,o.jsx)("a",{className:"inline-flex fw6 no-underline blue hover-lightest-blue items-center",href:"/@observablehq/troubleshooting-embedding",target:"_blank",rel:"noopener noreferrer",children:"Learn more"}),"."]}),V&&(0,o.jsx)("div",{className:"flex justify-center mh3",children:(0,o.jsxs)("div",{className:"flex pa1 mt3 f7 fw5 gold bg-washed-yellow br2 items-center",children:[(0,o.jsx)(_.Z,{className:"w1 h1 ma1",style:{strokeWidth:1,flexShrink:void 0}}),(0,o.jsx)("div",{className:"mr2 lh-copy",children:V})]})}),(0,o.jsx)("div",{className:"ma3",children:(0,o.jsxs)("div",{className:"pa2 mb2 bg-near-white br2 overflow-auto",style:{maxHeight:355},children:[(0,o.jsxs)("label",{htmlFor:"entire-type",className:"flex f6 fw5 dark-gray hover-blue flex-auto pointer",children:[(0,o.jsx)(Oe.X,{id:"entire-type",checked:g,onChange:function(e){return x(e.target.checked)},spacing:""}),"Entire notebook"]}),(0,o.jsx)("hr",{className:"bt b--black-10 br-0 bl-0 bb-0"}),C.map((function(e,t){var n=e.name,r="cell-"+n.replace(/ /g,""),i=g||M.has(n)||U.has(n);return(0,o.jsxs)("label",{htmlFor:r,className:"flex f6 fw5 flex-auto ".concat(t?"mt2":""," ").concat(i?"gray":"dark-gray hover-blue pointer"),children:[(0,o.jsx)(Oe.X,{id:r,checked:g||v.includes(n),className:i?"disabled":"",disabled:i,onChange:function(e){return function(e,t){p(t?v.concat([e]):v.filter((function(t){return t!==e})))}(n,e.target.checked)},spacing:""}),(0,o.jsx)("span",{className:"truncate",children:n})]},n)})),N>0&&(0,o.jsxs)("label",{htmlFor:"unnamed-checkbox",className:"flex mt2 f6 mid-gray flex-auto tooltipped tooltipped-n","aria-label":"Unnamed cells can only be embedded as part of the entire notebook",children:[(0,o.jsx)(Oe.X,{id:"unnamed-checkbox",checked:g,disabled:!0,className:g?"o-1":"o-0",spacing:""}),(0,o.jsxs)("span",{className:"i",children:[N," unnamed cell",N>1?"s":""]})]})]})}),(0,o.jsx)(Ae.P,{"aria-label":"Embed type",id:"type",value:w.name,onChange:function(e){return S(ut.find((function(t){return t.name===e.target.value})))},className:"mh3",children:ut.map((function(e){var t=e.name;return(0,o.jsx)("option",{children:t},t)}))}),(0,o.jsx)("div",{className:"ma3",children:L})]}),O>0&&(0,o.jsxs)("div",{className:"pv3 ph4 dark-gray bg-near-white bl b--light-gray br3 br--right",children:[(0,o.jsx)("div",{className:"mb3 pt2 f5 b--light-gray relative",children:"Preview"}),c?(0,o.jsx)("div",{style:{width:O},children:(0,o.jsxs)("div",{className:"center pa2 mt5 ba b--light-gray",style:{maxWidth:"24rem"},children:[(0,o.jsx)("strong",{children:"This notebook is still private."})," To preview and embed this notebook, it must be either link-shared or published.",(0,o.jsxs)("div",{className:"mt3 f7",children:["If you are only embedding on a secure and private intranet page, you may be able to use an"," ",(0,o.jsx)("a",{className:"blue hover-dark-blue link",href:"/@observablehq/api-keys",children:"API Key"}),"."]})]})}):g||v.length?z:(0,o.jsx)("div",{style:{width:O},children:(0,o.jsx)("div",{className:"mw6 center mt5 tc",children:"Select cells to see a preview of the embedded notebook."})})]})]})})),pt=n(65988),bt=n.n(pt),yt=n(93797),gt=n(12447),xt=n(89642),jt=n(66421),wt=n(24576),_t=n(73626);function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Nt={styles:(0,o.jsx)(bt(),{id:"b5ed204cf63838e",children:"@media ".concat(gt.pp," {[data-reach-dialog-content].jsx-b5ed204cf63838e{width:80vw;\nmax-width:47em}}\n@media screen and (min-width:47em) {[data-reach-dialog-content].jsx-b5ed204cf63838e{width:47em}}")}),className:"jsx-b5ed204cf63838e"},Ct=Nt.className,Tt=Nt.styles,Ot=(0,f.$j)((function(e){return{notebook:e.notebook}}),(function(e){return{dispatch:e}}))((function(e){var t=e.notebook,n=e.dispatch,i=e.onDismiss,s=t.model,l=s.license,c=s.copyright,u=t.owner,d=(0,h.useState)(l),m=d[0],f=d[1],p=(0,h.useState)(c),b=p[0],y=p[1],g=m&&"other"!==m;(0,h.useEffect)((function(){g&&!c&&y((0,xt.nm)(u))}),[u,c,g]);var x=(0,T.ZP)("".concat("https://static.observablehq.com","/licenses/").concat(m,".txt"),(function(e,t){return fetch(e,t).then((function(e){return e.text()}))})),j=x.data,w=x.error;if(w)throw w;var _=(0,jt.GL)(t);return(0,o.jsxs)(a.Vq,{onDismiss:i,"aria-labelledby":"modal-title",className:Ct,children:[(0,o.jsxs)(ve.l,{className:"f6 lh-copy",onSubmit:function(e){var t=m||null;i(),n({type:"relicense",license:t,copyright:g&&b?b:""}),e.preventDefault()},children:[(0,o.jsx)(r.xB,{title:g?(0,xt.ax)(m,"long"):"Notebook license",icon:yt.Z,onDismiss:i}),(0,o.jsxs)(r.fe,{children:[_?(0,o.jsxs)("div",{className:"mv3",children:[(0,o.jsxs)(Ae.P,{id:"license",value:m||"",onChange:function(e){return f(e.target.value||null)},className:"w-100 ".concat(m?"":"gray"),children:[(0,o.jsx)("option",{value:"",children:"None (please choose a license)"}),xt.B5.map((function(e){return[e,(0,xt.ax)(e)]})).sort((function(e,t){return e[1]>t[1]?1:-1})).map((function(e){var t=kt(e,2),n=t[0],r=t[1];return(0,o.jsx)("option",{value:n,children:r},n)}))]}),"other"===m?(0,o.jsx)("div",{className:"mt3 f7 fw5 mid-gray",children:"Please create a cell in your notebook with your license text."}):m?(0,o.jsx)(wt.g,{name:"copyright",placeholder:"Copyright [YEAR] [OWNER]",className:"w-100 mt3",value:b||"",maxLength:1024,rows:4,autoResize:!0,onChange:function(e){return y(e.target.value)}}):(0,o.jsx)("div",{className:"mt3 f7 fw5 mid-gray",children:"Licenses let others know how they can use your work."})]}):c?(0,o.jsx)("h4",{className:"mv3 f6 fw5 break-word pre-wrap",children:c}):null,g&&j&&(0,o.jsx)("div",{className:"pa2 mt3 code f7 pre ba b--light-silver br2",style:{maxHeight:400,minHeight:250},children:j})]}),(0,o.jsx)(r.mz,{children:(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsxs)("a",{className:"flex db f6 fw5 blue hover-lightest-blue items-center lh-solid link",href:g?"https://choosealicense.com/licenses/".concat(m,"/"):"https://observablehq.com/@observablehq/licenses",target:"_blank",rel:"noopener noreferrer",children:[(0,o.jsx)(_t.Z,{style:{background:"#dae4ff"},className:"dib w1 h1 mr2 fw7 tc light-blue lh-f6 br-pill"}),"Learn more about"," ",g?"the ".concat((0,xt.ax)(m)," license"):"licenses"]}),_?(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{text:"Cancel",onClick:i}),(0,o.jsx)(v.KM,{type:"submit",text:"Confirm",disabled:l===m&&c===b})]}):(0,o.jsx)(v.aX,{onClick:i,text:"Close"})]})})]}),Tt]})})),At=n(12204),It=n(26674),Dt=n(49061),Ft=n(76305),Pt=n(58127),Et=n(2741),Rt=n(2102);function Mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Mt(e,t,n[t])}))}return e}var Vt=(0,f.$j)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.onDismiss,n=e.fileToReplace,i=e.dispatch,s=function(e){if(e.length){var t=e[0];t.size>Fe.D_?(p(!0),d(null)):(d(t),p(!1))}},c=(0,h.useState)(),u=c[0],d=c[1],m=(0,h.useState)(),f=m[0],p=m[1],b=(0,Pt.Y)((function(e){var t=e.dataTransfer.files;s(Array.from(t))})),y=b.isDraggingOver,g=b.dragAndDropEvents;return(0,o.jsxs)(a.Vq,{onDismiss:t,"aria-labelledby":"modal-title","data-dialog-wide":!0,children:[(0,o.jsx)(r.xB,{title:"Replace file",icon:l.Z,onDismiss:t}),(0,o.jsx)(r.fe,{children:(0,o.jsxs)("div",{children:[f?(0,o.jsx)(Dt.b,{type:"error",spacing:"pv2 ph3",className:"flex pv1 mb2 f7 fw6 flex-no-shrink items-center lh-f7",children:(0,o.jsxs)("div",{className:"ml1 fw5 dark-gray",children:["Sorry, that file exceeds the"," ",(0,Rt.B)(Fe.D_)," maximum size."]})}):null,(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"pb2 mb2",children:"All references to\u2026"}),(0,o.jsx)("div",{className:"pa3 ba b--silver br2 bg-white",children:(0,o.jsx)(It.J,{file:n,used:!0})}),(0,o.jsxs)("div",{className:"flex mt3 mb2 justify-between items-baseline",children:[(0,o.jsx)("div",{className:"pv2",children:"will be replaced with\u2026"}),u?(0,o.jsx)(v.sn,{text:"Select another",onClick:function(){i({type:"notebookFilePickerOpened",source:"replaceFileModal",trigger:"click"}),(0,Et.Z)({multiple:!1}).then(s)}}):null]}),(0,o.jsx)("div",Ut({className:"pa3 ba br2 ".concat(y?"b--gray b--dashed bg-black-05":"b--silver bg-white"),"data-cy":"drop-target"},g,{children:u?(0,o.jsx)(It.J,{file:{name:u.name,createTime:new Date,mimeType:u.type,status:"local",blob:u,size:u.size}}):(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(v.KM,{text:"Select a file",icon:Ft.Z,onClick:function(){i({type:"notebookFilePickerOpened",source:"replaceFileModal",trigger:"click"}),(0,Et.Z)({multiple:!1}).then(s)}}),(0,o.jsx)("span",{className:"mid-gray ml2",children:"or drag and drop"})]})}))]})]})}),(0,o.jsx)(r.mz,{children:(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{text:"Cancel",onClick:t}),(0,o.jsx)(v.KM,{onClick:function(){i({type:"fileReplaced",fileToAttach:u,fileToReplace:n}),t()},disabled:!u,text:"Confirm"})]})})]})})),Zt=n(56367),qt=n(64893),Lt=(0,f.$j)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,n=e.comment,i=e.onDismiss,s=function(){t({type:"reportAbuse",anonymous:f,comment:n,reason:u}),i()},l=(0,h.createRef)(),c=(0,h.useState)(""),u=c[0],d=c[1],m=(0,h.useState)(!1),f=m[0],p=m[1];return(0,o.jsxs)(a.Vq,{onDismiss:i,"aria-labelledby":"modal-title",initialFocusRef:l,children:[(0,o.jsx)(r.xB,{title:"Report spam or abuse",icon:_.Z,onDismiss:i}),(0,o.jsxs)(r.fe,{children:[(0,o.jsx)(zt,{comment:n}),(0,o.jsxs)("div",{className:"mv3",children:["Please describe why this comment violates Observable\u2019s"," ",(0,o.jsx)("a",{className:"no-underline blue",target:"_blank",rel:"noopener noreferrer",href:"/@observablehq/code-of-conduct",children:"Code of Conduct"}),"."]}),(0,o.jsx)(wt.g,{ref:l,maxLength:255,placeholder:"Reason (optional)",value:u,onChange:function(e){var t=e.target.value;return d(t)},onKeyPress:function(e){"Enter"===e.key&&e.metaKey&&(e.preventDefault(),s())},className:"w-100"}),(0,o.jsx)(Oe.X,{label:"Allow Observable support to follow up with me",checked:!f,onChange:function(e){var t=e.target.checked;return p(!t)}}),(0,o.jsxs)("p",{className:"mt2 mid-gray",children:[f?(0,o.jsx)(o.Fragment,{children:"Your report will be sent anonymously and we will have no way to follow up with you."}):(0,o.jsx)(o.Fragment,{children:"Your contact information will be included so that we may follow up with you."})," ","If you prefer, you can report via email to"," ",(0,o.jsx)("a",{className:"no-underline blue",href:"mailto:conduct@observablehq.com",children:"conduct@observablehq.com"}),"."]})]}),(0,o.jsx)(r.mz,{children:(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{onClick:i,text:"Cancel"}),(0,o.jsx)(v.KM,{text:"Send report",onClick:s})]})})]})})),zt=function(e){var t=e.comment,n=t.content,r=t.create_time,i=t.update_time,a=t.user;return(0,o.jsxs)("div",{className:"mb3 pv2 ph3 dark-gray bg-washed-yellow br2 b--silver ba",children:[(0,o.jsxs)("div",{className:"pb1 flex items-center",children:[(0,o.jsx)(G.Z,{href:(0,re.GN)(a),children:(0,o.jsxs)("a",{className:"inline-flex truncate no-underline dark-gray hover-blue items-center mr2",children:[(0,o.jsx)(se.q,{user:a,size:24,className:"mr2 br-100"}),(0,o.jsx)("span",{className:"truncate fw5",children:(0,ee.KY)(a)})]})}),(0,te.tO)(t)?null:(0,o.jsx)(qt.i,{className:"mid-gray nowrap",time:i||r})]}),(0,o.jsx)("div",{className:"overflow-x-hidden break-word",children:(0,o.jsx)(Zt.R,{content:n})})]})},$t=n(15706),Bt=(0,f.$j)((function(e){return{notebook:e.notebook}}),(function(e){return{dispatch:e}}))((function(e){var t=e.notebook,n=e.dispatch,i=e.onDismiss,s=(0,h.useState)(""),l=s[0],c=s[1],u=t.forkOf.owner;return(0,o.jsx)(a.Vq,{onDismiss:i,"aria-labelledby":"modal-title",children:(0,o.jsxs)(ve.l,{onSubmit:function(e){e.preventDefault(),n({type:"sendSuggestion",description:l,trigger:"click",source:"notebookContextMenu"})},children:[(0,o.jsx)(r.xB,{title:"Send suggestion",icon:$t.v,onDismiss:i}),(0,o.jsxs)(r.fe,{children:["Your changes will be sent to"," ",u.id!==t.owner.id||"team"!==u.type?(0,o.jsx)("b",{children:(0,re.RX)(u)}):(0,o.jsxs)(o.Fragment,{children:["the authors of ",(0,o.jsxs)("b",{children:["\u201c",(0,Fe.$h)(t.forkOf),"\u201d"]})]})," ","for review.",(0,o.jsx)(p.Z,{type:"text",maxLength:255,placeholder:"Brief description of changes\u2026",value:l,onChange:function(e){var t=e.target.value;return c(t)},className:"w-100 mt3"}),(0,te.ws)(t)&&t.owner.id!==u.id&&(0,o.jsx)("div",{className:"mt2 f7 mid-gray",children:"This notebook will be visible to anyone with the link."})]}),(0,o.jsx)(r.mz,{children:(0,o.jsxs)(v.CQ,{children:[(0,o.jsx)(v.kq,{text:"Cancel",onClick:i}),(0,o.jsx)(v.KM,{type:"submit",loading:t.isSuggesting,text:"Confirm"})]})})]})})}));function Kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xt=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Kt(e,t,n[t])}))}return e}({},i.$,{addCloudFile:Y,addDatabase:ae,authors:ke,closeSuggestion:Ne,cloudFile:function(e){var t=e.provider,n=e.onDismiss;return"microsoftData"===t?(0,o.jsx)($,{onDismiss:n}):"googleData"===t?(0,o.jsx)(X,{onDismiss:n}):null},deleteComment:Ce,deleteFile:Te,embed:vt,license:Ot,oauth:function(e){var t=e.onDismiss,n=e.dismissable,r=void 0===n||n,i=e.provider,s=e.continuePath,l=(void 0===s?"":s)||location.pathname,u=(0,h.useState)(""),m=u[0],f=u[1],v=(0,h.useState)(!1),b=v[0],y=v[1],g=(0,h.useRef)(null),j=(0,h.useCallback)((function(){y(!0),g.current&&(g.current.token.value=(0,c.FN)(),g.current.submit())}),[]),w=d.c[i],_=w.name,S=w.icon,k=w.scopes;return(0,o.jsx)(a.Vq,{onDismiss:r?t:void 0,"aria-label":"Authorize",className:"narrow",children:(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{className:"mb3 pt2",children:"This notebook requires access to a file stored on Microsoft Drive. Please grant access to Observable to continue."}),(0,o.jsxs)("form",{action:"".concat("https://api.observablehq.com","/user/token/authorize"),method:"post",ref:g,children:[(0,o.jsxs)("label",{htmlFor:"provider_id",children:[(0,o.jsx)("div",{className:"h1 f6 near-black",children:"Your username"}),(0,o.jsx)(p.Z,{required:!0,name:"provider_id",spellCheck:"false",autoComplete:"email",autoCorrect:"off",autoCapitalize:"none",minLength:1,maxLength:255,className:"w-100 mt2",onChange:function(e){return f(e.target.value)},value:m})]}),(0,o.jsx)("input",{type:"hidden",name:"token"}),(0,o.jsx)("input",{type:"hidden",name:"path",value:l}),(0,o.jsx)("input",{type:"hidden",name:"scopes",value:k.join(" ")}),(0,o.jsx)("input",{type:"hidden",name:"provider",value:i}),(0,o.jsxs)("button",{onClick:j,type:"button",className:(0,At.XK)(),children:[b?(0,o.jsx)(x.Z,{className:"ml1 mr2 dark-gray"}):(0,o.jsx)(S,{className:"w1 h1 ml1 mr2"}),"Continue with ",_]})]})]})})},replaceFile:Vt,reportAbuse:Lt,suggest:Bt}),Qt=(0,r.zm)(Xt)},87:function(e,t,n){n.d(t,{D:function(){return C}});var r=n(40802),i=n(13819),o=n(6917),a=n(602),s=n(5969),l=n(51970),c=n(31946),u=n(66421),d=n(25655),m=n(37724),h=n(95757);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function j(e,t){return e.version<t.version||e.version===t.version&&e.subversion<t.subversion}var w=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dispatch=t,this.clientRole=n,this.id=r,this._state="closed",this._clientStateTimer=null,this._socket=null,this._token=null,this._reopenDelay=250,this._staleDelay=6e4,this._reopenTimer=null,this._pingInterval=null,this._staleTimer=null,this._saveFocusId=null,this._saveSelection=null,this._saveVersionPair=null,this._saveSnapshot=null,this._savingFromStash=!1,this._stashTimer=null,this._notebookState=null,this._currentUser=null,this._saveSelectionTimer=null,this._savingFiles=new Set,this._deletingFiles=new Set,this._savingComments=new Set,this._resolvingComments=new Set,this._deletingComments=new Set,this._lastSavedFiles=null,this._lastSavedComments=null,this._isSettingState=!1,this._reopen=function(){if("reopening"!==i._state)throw new Error("unexpected state: ".concat(i._state.toString()));i._reopenTimer&&(clearTimeout(i._reopenTimer),i._reopenTimer=null),document.hidden||(i._staleTimer||(i._staleTimer=setTimeout(i._stale,i._staleDelay)),i._token=(0,a.FN)(),i._socket=new WebSocket("".concat((0,c.ke)(),"/document/").concat(i.id,"/").concat(i.clientRole)),i._socket.addEventListener("open",i._opened),i._socket.addEventListener("close",i._closed),i._socket.addEventListener("message",i._messaged),i._updateState("opening"))},this._opened=function(){if("opening"!==i._state)throw new Error("unexpected state: ".concat(i._state.toString()));i._updateState("greeting"),i._send({type:"hello",token:i._token,version:i._saveVersionPair.version,next:!0}),i._pingInterval=setInterval(i._ping,3e4)},this._closed=function(){isFinite(i._reopenDelay)&&(i._reopenDelay=Math.min(6e4,i._reopenDelay*(1+Math.random()))),i._reopenTimer&&(clearTimeout(i._reopenTimer),i._reopenTimer=null),i._pingInterval&&(clearInterval(i._pingInterval),i._pingInterval=null),i._saveSelectionTimer&&(clearTimeout(i._saveSelectionTimer),i._saveSelectionTimer=null),i._stashTimer&&(clearTimeout(i._stashTimer),i._stashTimer=null),i._clientStateTimer&&(clearTimeout(i._clientStateTimer),i._clientStateTimer=null),i._reopenTimer=setTimeout(i._reopen,i._reopenDelay),i._updateState("reopening"),i._socket=null,i._saveFocusId=null,i._saveSelection=null,i._saveSnapshot=null,i._savingFromStash=!1,i._token=null},this._stale=function(){i.close()},this._ping=function(){document.hidden||i._send({type:"ping"})},this._updateState=function(e){if(i._state!==e){var t=i._state;if(i._state=e,i._clientStateTimer)"idle"===e&&(clearTimeout(i._clientStateTimer),i._clientStateTimer=null);else if("idle"===t&&"saving"===e){var n=i;i._clientStateTimer=setTimeout((function(){n._dispatch({type:"clientStateChanged",clientState:n._state}),n._clientStateTimer=null}),2e3)}else i._dispatch({type:"clientStateChanged",clientState:i._state})}},this._visibilitychanged=function(){document.hidden?i._staleTimer&&(clearTimeout(i._staleTimer),i._staleTimer=null):"reopening"===i._state?i._reopen():!i._staleTimer&&i._socket&&(i._staleTimer=setTimeout(i._stale,i._staleDelay))},this._messaged=function(e){var t=JSON.parse(e.data,l.j);switch(i._staleTimer&&clearTimeout(i._staleTimer),i._staleTimer=setTimeout(i._stale,i._staleDelay),t.type){case"hello":return"greeting"!==i._state?i.abort("unexpected hello"):(i._reopenDelay=Math.max(250,i._reopenDelay/10),void i._updateState("loading"));case"load":if("loading"!==i._state)return i.abort("unexpected load");if(i._updateState("idle"),"comments"===i.clientRole)return;var n=function(e){if(!("events"in e))throw new Error("Expected complete load message, got incomplete");return e}(t),r=n.events,o=n.edits,a=n.version,s=n.subversion,c={version:a,subversion:s};if(j(c,i._saveVersionPair))return i.abort("load - version skew");if(i._handleReverts(r))return;return i._saveVersionPair=c,i._dispatch({type:"synced",saveVersion:a,saveSubversion:s,saveTime:new Date,events:r,edits:o}),void i._save();case"error":if("saving"!==i._state)return i.abort("unexpected error");i._updateState("idle");var u=i._saveSnapshot,d=u.version,m=u.subversion;return i._saveSnapshot=null,i._savingFromStash=!1,void(j({version:d,subversion:m},i._saveVersionPair)&&i._save());case"saveconfirm":var h=t.version,f=t.subversion;if("saving"!==i._state)return i.abort("unexpected saveconfirm");if(j({version:h,subversion:f},i._saveVersionPair))return i.abort("saveconfirm message - version skew");i._stashTimer&&(clearTimeout(i._stashTimer),i._stashTimer=null),i._updateState("idle");var v=i._saveSnapshot,p=v.events,g=v.edits;return i._saveSnapshot=null,i._saveVersionPair={version:h,subversion:f},i._savingFromStash?(i._savingFromStash=!1,i._clearStash(),i._dispatch({type:"saveReceived",saveVersion:h,saveSubversion:f,saveTime:new Date,events:p,edits:g})):i._dispatch({type:"saveConfirmed",saveVersion:h,saveSubversion:f,saveTime:new Date,events:p,edits:g}),void(i._notebookState&&"default"===i._notebookState.subscriptionState&&i._dispatch({type:"updateSubscription",status:"comments"}));case"save":var x=t.events,w=t.edits,_=t.version,S=t.subversion;if(j({version:_,subversion:S},i._saveVersionPair))return i.abort("save message - version skew");if(i._handleReverts(x))return;return i._saveVersionPair={version:_,subversion:S},void i._dispatch({type:"saveReceived",saveVersion:_,saveSubversion:S,saveTime:new Date,events:x,edits:w});case"comments":return void i._dispatch({type:"commentsUpdated",comments:t.comments});case"file":return void i._dispatch({type:"remoteFileUpdated",file:t.file,ownUpload:i._savingFiles.has(t.file.name)});case"presence":var k=t.participants.slice();if(k.length&&null!==i._currentUser){var N=i,C=t.participants.findIndex((function(e){return e.id===N._currentUser.id}));if(C>=0){var T=y(k.splice(C,1),1)[0];k.unshift(T)}else{var O=b({},i._currentUser,{node_ids:[],selections:[]});k.unshift(O)}}return void i._dispatch({type:"presence",participants:k});case"commentmodifyconfirm":return;case"commentresolveconfirm":return void i._dispatch({type:"resolveCommentsConfirmed",ids:t.ids});case"commentconfirm":return void i._dispatch({type:"commentSaveConfirmed",nonce:t.nonce,id:t.id,createTime:new Date(t.create_time),updateTime:null===t.update_time?null:new Date(t.update_time)});case"commentdeleteconfirm":return void i._dispatch({type:"commentsDeleteConfirmed",ids:t.ids});case"commentlock":return void i._dispatch({type:"commentingLockSaved",commentingLock:t.lockStatus});case"subscription":var A,I="none"===t.status?"none":"comments";(null===(A=i._notebookState)||void 0===A?void 0:A.subscriptionState)!==I&&i._dispatch({type:"updateSubscriptionSucceeded",status:I,trigger:void 0,source:void 0});break;case"pong":return}},this._setStash=function(){var e=i._notebookState,t=e.model,n=e.editorStates,r=e.saveVersion,o=e.saveSubversion,a=t.events.slice(r+1).map((function(e){return(0,h.e)(e)})),s=_(n);m.X.setItem("notebook-next-".concat(i.id),JSON.stringify({events:a,edits:s,version:r,subversion:o})),i._stashTimer=null}}var t,n,o;return t=e,(n=[{key:"setState",value:function(e,t){if(this._isSettingState)throw this._isSettingState=!1,new Error("Reentrant client setState call");try{if(this._isSettingState=!0,"aborted"===this._state)return;var n=e.saveVersion,r=e.saveSubversion,i=e.id,o=e.clientState;if(i!==this.id)throw new Error("cannot set client state - unstable id");if((0,u.ZK)(e)!==this.clientRole)throw new Error("cannot set client state - unstable role");if("aborted"===o)throw new Error("cannot set client state - client aborted");if(this._notebookState=e,this._currentUser=t,"closed"===this._state)this._saveVersionPair={version:n,subversion:r},this._updateState("reopening"),this._reopen(),document.addEventListener("visibilitychange",this._visibilitychanged);else{if(j(this._saveVersionPair,{version:n,subversion:r}))throw new Error("cannot set client state - version skew");this._save()}}finally{this._isSettingState=!1}}},{key:"_cleanup",value:function(){this._saveFocusId=null,this._saveSelection=null,this._saveSnapshot=null,this._saveVersionPair=null,this._savingFromStash=!1,this._notebookState=null,this._currentUser=null,this._token=null,this._reopenTimer&&(clearTimeout(this._reopenTimer),this._reopenTimer=null),this._pingInterval&&(clearInterval(this._pingInterval),this._pingInterval=null),this._staleTimer&&(clearTimeout(this._staleTimer),this._staleTimer=null),this._saveSelectionTimer&&(clearTimeout(this._saveSelectionTimer),this._saveSelectionTimer=null),this._stashTimer&&(clearTimeout(this._stashTimer),this._stashTimer=null),this._clientStateTimer&&(clearTimeout(this._clientStateTimer),this._clientStateTimer=null),this._socket&&(this._socket.removeEventListener("open",this._opened),this._socket.removeEventListener("close",this._closed),this._socket.removeEventListener("message",this._messaged),this._socket.close(),this._socket=null),document.removeEventListener("visibilitychange",this._visibilitychanged)}},{key:"close",value:function(){"closed"!==this._state&&"aborted"!==this._state&&(this._cleanup(),this._updateState("closed"))}},{key:"abort",value:function(e){e&&console.error(e),"aborted"!==this._state&&(this._cleanup(),this._updateState("aborted"),(0,r.uT)(e||"unknown abort",i.z.Error))}},{key:"_send",value:function(e){if(!this._socket)throw new Error("No socket at this._socket");this._socket.send(JSON.stringify(e))}},{key:"_handleReverts",value:function(e){var t=e.filter((function(e){return"revert"===e.type}));return t.length>0&&(this._dispatch({type:"revertRequested",version:t[t.length-1].node_id,saveVersion:t[t.length-1].version,remote:!0}),this.close(),!0)}},{key:"_save",value:function(){if("edit"===this.clientRole){if((0,d.oI)(this._notebookState)&&!this._stashTimer&&(this._stashTimer=setTimeout(this._setStash,1e3)),"idle"===this._state){var e=this._notebookState;j({version:e.saveVersion,subversion:e.saveSubversion},this._saveVersionPair)||this._saveChanges()||(this._saveFiles(),this._saveNewFocus(),this._saveComments())}}else this._saveComments()}},{key:"_saveChanges",value:function(){var e=this._notebookState,t=e.model,n=e.editorStates,r=t.events.slice(this._saveVersionPair.version+1).map((function(e){return(0,h.e)(e)})),i=_(n);if(!r.length&&!i.length){var o,a=this._getStash();((null===a||void 0===a?void 0:a.events.length)||(null===a||void 0===a?void 0:a.edits.length))&&(r=(o=a).events,i=o.edits,this._savingFromStash=!0)}return!(!r.length&&!i.length)&&(this._updateState("saving"),this._saveSnapshot=b({events:r,edits:i},this._saveVersionPair),this._send(b({type:"save",events:r,edits:i},this._saveVersionPair)),!0)}},{key:"_saveFiles",value:function(){var e=this._notebookState.files;if(e!==this._lastSavedFiles){this._lastSavedFiles=e;var t=!0,n=!1,r=void 0;try{for(var i,o=this._savingFiles[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a,l=i.value;"local"!==(null===(a=e.get(l))||void 0===a?void 0:a.status)&&this._savingFiles.delete(l)}}catch(k){n=!0,r=k}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}var c=!0,u=!1,d=void 0;try{for(var m,h=this._deletingFiles[Symbol.iterator]();!(c=(m=h.next()).done);c=!0){var f,v=m.value;"deletepending"!==(null===(f=e.get(v))||void 0===f?void 0:f.status)&&this._deletingFiles.delete(v)}}catch(k){u=!0,d=k}finally{try{c||null==h.return||h.return()}finally{if(u)throw d}}var p=!0,b=!1,g=void 0;try{for(var x,j=e[Symbol.iterator]();!(p=(x=j.next()).done);p=!0){var w=y(x.value,2),_=w[0],S=w[1];this._savingFiles.has(_)||this._deletingFiles.has(_)||("local"===S.status&&(this._savingFiles.add(_),(0,s.mU)({id:this.id,name:_,file:S.blob,dispatch:this._dispatch}).catch((function(){}))),"deletepending"===S.status&&(this._deletingFiles.add(_),(0,s.T4)({id:this.id,name:_,dispatch:this._dispatch})))}}catch(k){b=!0,g=k}finally{try{p||null==j.return||j.return()}finally{if(b)throw g}}}}},{key:"_saveComments",value:function(){var e=this._notebookState.comments;if(e!==this._lastSavedComments){this._lastSavedComments=e;var t=new Map,n=new Set,r=new Set,i=new Set,o=new Set,a=new Set,s=!0,l=!1,c=void 0;try{for(var u,d=e[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var m=y(u.value,2),h=m[0],f=m[1],v=!0,p=!1,b=void 0;try{for(var g,x=f[Symbol.iterator]();!(v=(g=x.next()).done);v=!0){var j=g.value;switch(j.status){case"local":this._savingComments.has(j.nonce)?i.add(j.nonce):t.set(j.nonce,{nodeId:h,content:j.content});break;case"deletePending":this._deletingComments.has(j.id)?a.add(j.id):n.add(j.id);break;case"resolvePending":this._resolvingComments.has(j.id)?o.add(j.id):r.add(j.id)}}}catch(le){p=!0,b=le}finally{try{v||null==x.return||x.return()}finally{if(p)throw b}}}}catch(le){l=!0,c=le}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}var w=!0,_=!1,S=void 0;try{for(var k,N=this._savingComments[Symbol.iterator]();!(w=(k=N.next()).done);w=!0){var C=k.value;i.has(C)||this._savingComments.delete(C)}}catch(le){_=!0,S=le}finally{try{w||null==N.return||N.return()}finally{if(_)throw S}}var T=!0,O=!1,A=void 0;try{for(var I,D=this._deletingComments[Symbol.iterator]();!(T=(I=D.next()).done);T=!0){var F=I.value;a.has(F)||this._deletingComments.delete(F)}}catch(le){O=!0,A=le}finally{try{T||null==D.return||D.return()}finally{if(O)throw A}}var P=!0,E=!1,R=void 0;try{for(var M,U=this._resolvingComments[Symbol.iterator]();!(P=(M=U.next()).done);P=!0){var V=M.value;o.has(V)||this._resolvingComments.delete(V)}}catch(le){E=!0,R=le}finally{try{P||null==U.return||U.return()}finally{if(E)throw R}}if(t.size){var Z=!0,q=!1,L=void 0;try{for(var z,$=t[Symbol.iterator]();!(Z=(z=$.next()).done);Z=!0){var B=y(z.value,2),K=B[0],X=B[1],Q=X.nodeId,J=X.content;this._savingComments.add(K),this._send({type:"comment",content:J,nonce:K,node_id:Q})}}catch(le){q=!0,L=le}finally{try{Z||null==$.return||$.return()}finally{if(q)throw L}}}if(n.size){var W=!0,Y=!1,H=void 0;try{for(var G,ee=n[Symbol.iterator]();!(W=(G=ee.next()).done);W=!0){var te=G.value;this._deletingComments.add(te)}}catch(le){Y=!0,H=le}finally{try{W||null==ee.return||ee.return()}finally{if(Y)throw H}}this._send({type:"commentdelete",ids:Array.from(n)})}if(r.size){var ne=!0,re=!1,ie=void 0;try{for(var oe,ae=r[Symbol.iterator]();!(ne=(oe=ae.next()).done);ne=!0){var se=oe.value;this._resolvingComments.add(se)}}catch(le){re=!0,ie=le}finally{try{ne||null==ae.return||ae.return()}finally{if(re)throw ie}}this._send({type:"commentresolve",ids:Array.from(r),resolved:!0})}}}},{key:"_saveNewFocus",value:function(){var e=this._notebookState,t=e.saveVersion,n=e.saveSubversion,r=e.editorStates,i=e.focusId,o=null!==i?r.get(i):null,a=(null===o||void 0===o?void 0:o.selection)||null;if(this._saveFocusId!==i||this._saveSelection!==a){var s=this;this._saveFocusId=i,this._saveSelection=a,this._saveSelectionTimer&&clearTimeout(this._saveSelectionTimer),this._saveSelectionTimer=setTimeout((function(){s._send({type:"focus",node_id:i,selection:a&&a.toJSON(),version:t,subversion:n}),s._saveSelectionTimer=null}),100)}}},{key:"_getStash",value:function(){var e=m.X.getItem("notebook-next-".concat(this.id));if(e){var t=JSON.parse(e,l.j);return t.version!==this._saveVersionPair.version||t.subversion!==this._saveVersionPair.subversion?void 0:t}}},{key:"_clearStash",value:function(){m.X.removeItem("notebook-next-".concat(this.id))}}])&&v(t.prototype,n),o&&v(t,o),e}();function _(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=function(e,n){var r,i=y(n.value,2),a=i[0],s=i[1],l=(0,o.hp)(s);(r=t).push.apply(r,g(l.map((function(e){return function(e,t){var n=[];return e.changes.iterChanges((function(e,t,r,i,o){n.push({from:e,to:t,insert:o.toString()})})),{node_id:t,length:e.changes.desc.length,changes:n}}(e,a)}))))},l=e[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)s(0,a)}catch(c){r=!0,i=c}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}var S=n(74080),k=n(67294),N=n(76020);function C(e){var t,n=function(){t&&t.close(),t=void 0},r=(0,N.x)(e,(function(){var r=e.getState(),i=r.notebook,o=r.currentUser,a=i.id,s=(0,u.ZK)(i);(0,S.QY)(i)?(t&&t.id===a&&t.clientRole===s||(n(),t=new w((0,N.Q)(e),s,a)),t.setState(i,o)):n()}));(0,k.useEffect)((function(){return function(){n(),r()}}))}},64889:function(e,t,n){n.d(t,{C:function(){return s}});var r=n(19671),i=n(51289),o=n(61107),a=n(67294);function s(e,t){(0,a.useEffect)((function(){var n=function(n){var i=n.reason?n.reason.toString():n.message,s=!0,l=!1,c=void 0;try{for(var u,d=o.z[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){if(u.value.test(i))return}}catch(f){l=!0,c=f}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}var m=Date.now(),h=a.get(i);m-Number(h)<6e4||(a.set(i,m),(0,r.MR)((0,r.a$)({type:"error",data:{error:i},eventVersion:1,currentUser:e})),t({type:"showErrorToast",message:"Oops, an unexpected error occurred",key:"errorHandler"}))},a=new Map;return i.Qg&&(addEventListener("unhandledrejection",n),addEventListener("error",n)),function(){i.Qg&&(removeEventListener("unhandledrejection",n),removeEventListener("error",n))}}),[t,e])}},81816:function(e,t,n){function r(e){var t=new URLSearchParams,n=!0,r=!1,i=void 0;try{for(var o,a=Object.keys(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=e[s];void 0!==l&&t.append(s,l.toString())}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.toString()}n.d(t,{P:function(){return r}})}}]);
